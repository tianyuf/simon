# Nginx configuration snippet for Simon Papers
# Add this to your existing server block in /etc/nginx/sites-available/tfang.info
# (or wherever your main site config is)

# Simon Papers application
location /simon {
    # Proxy to Gunicorn (keep /simon prefix - middleware handles it)
    proxy_pass http://127.0.0.1:8001;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # Timeout settings for slow requests
    proxy_connect_timeout 60s;
    proxy_read_timeout 120s;
}

# Serve static files directly (optional optimization)
location /simon/static {
    alias /var/www/tfang.info/html/simon/web/static;
    expires 7d;
    add_header Cache-Control "public, immutable";
}

# Serve PDFs directly (optional optimization)
location /simon/pdf {
    alias /var/www/tfang.info/html/simon/pdfs;
    expires 1d;
}
